```mermaid
graph TD
    A[SqrtKeypointVio::process] --> B{Is initialized}
    B -- No --> C[vioInitialize]
    C --> D{Initialization success}
    D -- No --> E[Return empty SlamOutput]
    D -- Yes --> F[Set initialized = true]
    F --> G[Update timestamps: cur_t_ns_, prev_t_ns_]
    
    
    B -- Yes --> G

    G --> H[Build OpticalFlowResult from track/detect]
    H --> I[processImuMeas]
    I --> J[processVisionMeas]
    J --> K[Solve Optimization with Sliding Window]

    K --> L{Is keyframe}
    L -- Yes --> M[Add Keyframe + Update IMU State]
    L -- No --> N[Skip Keyframe Update]

    M --> O[Update Landmark Database]
    N --> O

    O --> P[Generate SlamOutput]
    P --> Q[Return result]

    %% B --> C[solve主优化]
    %% C --> D[createVariablesAndFactors]
    %% D --> E{{迭代循环}}
    %% E --> F[linearizeSystem]
    %% F --> G[linearSolve]
    %% G --> H{checkStepSuccess?}
    %% H -- 是 --> I[acceptStep]
    %% H -- 否 --> J[rejectStep]
    %% I --> E
    %% J --> E
    %% E --> K[marginalize]
    %% K --> L[generateNewMarginPrior]
    %% K --> M[createMarginVariableAndFactors]
    
    %% subgraph 辅助操作
    %%     N[backup/restore]
    %%     O[checkMarginPriorNullSpace]
    %%     P[updateOnlineCalib]
    %% end
    %% C --> N
    %% K --> O
    %% C --> P

```