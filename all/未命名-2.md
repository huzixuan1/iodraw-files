```mermaid
```mermaid
@startuml
namespace xr {

abstract class VioApi {
  +InitParam
  +bool init(const InitParam& init_param)
  +virtual bool process(const FeatureTrackOutput&, const FeatureDetectFrame&, const ImuPack&, SlamOutput&) = 0
  +virtual bool reset()
  +virtual bool reset(const ImuState& state)
  +virtual void setInitPriorPose(const TimedPose& tpose)
  +virtual void updateTrackMap(const TrackMap::Ptr& track_map)
  +virtual bool isInitializing() const
  +static Ptr create(VioMethod method)
  +static VioApi* createUnsafe(VioMethod method)
  #bool initImpl() = 0

  -- Attributes --
  #bool init_
  #InitParam init_param_
}

class VioOptimization {
  +VioOptimization()
  +virtual ~VioOptimization()
  +virtual bool process(const FeatureTrackOutput&, const FeatureDetectFrame&, const ImuPack&, SlamOutput&)
  +virtual bool reset()
  +virtual bool reset(const ImuState& state)
  +virtual void setInitPriorPose(const TimedPose& tpose)
  +virtual bool isInitializing() const

  -- Protected Methods --
  #virtual bool initImpl()

  -- Private Attributes --
  -SqrtKeypointVio::Ptr vio_
  -SlamOutput latest_output_
  -vs::BoolTimer timer_large_vel_
  -vs::BoolTimer timer_bad_bias_
  -vs::BoolTimer timer_far_range_
  -std::deque<std::pair<Tsec, float>> historty_outlier_rates_
  -void resetCache()
  -bool checkVioLost()
}

VioApi <|-- VioOptimization
}

enum VioMethod {
  VIO_METHOD_OPTIMIZATION
  VIO_METHOD_EKF
  VIO_METHOD_BASALT
  VIO_METHOD_HYBVIO
  VIO_METHOD_CERES
}
@enduml

```