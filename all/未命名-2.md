```mermaid

graph TD
    A[Solver构造函数] --> B[system initial]
    B --> C[solve]
    C --> D[createVariablesAndFactors]
    Q --> D[]
    D --> E{{迭代循环}}
    E --> F[linearizeSystem]
    F --> G[linearSolve]
    G --> H{checkStepSuccess?}
    H -- 是 --> I[acceptStep]
    H -- 否 --> J[rejectStep]
    I --> E
    J --> E
    E --> K[marginalize]
    K --> L[generateNewMarginPrior]
    K --> M[createMarginVariableAndFactors]
    
    subgraph 辅助操作
        N[backup/restore]
        O[checkMarginPriorNullSpace]
        P[updateOnlineCalib]
    end
    C --> N
    K --> O
    C --> P
```